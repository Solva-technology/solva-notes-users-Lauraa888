{% extends "base.html" %}

{% block title %}–í—Å–µ –∑–∞–º–µ—Ç–∫–∏{% endblock %}

{% block content %}
<h1>–°–ø–∏—Å–æ–∫ –∑–∞–º–µ—Ç–æ–∫</h1>

<!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–º–µ—Ç–∫–∏ -->
<a href="{% url 'note_create' %}">‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É</a>
<br><br>

<form method="get">
    <label>–°—Ç–∞—Ç—É—Å:</label>
    <select name="status">
        <option value="">–í—Å–µ</option>
        {% for s in statuses %}
            <option value="{{ s.id }}"
                {% if selected_status == s.id|stringformat:"s" %}selected{% endif %}>
                {{ s.name }}
            </option>
        {% endfor %}
    </select>

    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
    <select name="category">
        <option value="">–í—Å–µ</option>
        {% for c in categories %}
            <option value="{{ c.id }}"
                {% if selected_category == c.id|stringformat:"s" %}selected{% endif %}>
                {{ c.name }}
            </option>
        {% endfor %}
    </select>

    <button type="submit">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
</form>

<hr>

{% for note in notes %}
    <div>
        <h3>{{ note.content|slice:":100" }}...</h3>

        <p>–ê–≤—Ç–æ—Ä: {{ note.author.username }}</p>
        <p>–°—Ç–∞—Ç—É—Å: {{ note.status.name }}</p>
        <p>–î–∞—Ç–∞: {{ note.created_at }}</p>

        <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:
            {% if note.category %}
                {{ note.category.name }}
            {% else %}
                ‚Äî
            {% endif %}
        </p>

        <a href="{% url 'note_detail' note.id %}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>

        <!-- –î–æ—Å—Ç—É–ø –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é/—É–¥–∞–ª–µ–Ω–∏—é —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä—É –∏–ª–∏ –∞–¥–º–∏–Ω—É -->
        {% if request.user == note.author or request.user.is_staff %}
            <a href="{% url 'note_edit' note.id %}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{% url 'note_delete' note.id %}">üóë –£–¥–∞–ª–∏—Ç—å</a>
        {% endif %}

        <hr>
    </div>
{% endfor %}

{% endblock %}
